@model DNUStudyPlanner.Models.MySubjectsViewModel
@{
    ViewData["Title"] = "M√¥n h·ªçc c·ªßa t√¥i";
    Layout = null;
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="~/css/mysubjects.css" />
</head>
<body>
    <div class="sidebar">
        <h2>DNU Study Planner</h2>
        <a href="/Home/Dashboard">üè† Trang t·ªïng quan</a>
        <a href="/Home/Plan">üìÖ K·∫ø ho·∫°ch h·ªçc t·∫≠p</a>
        <a href="/Home/Profile">üë§ H·ªì s∆° c√° nh√¢n</a>
        <a href="/Home/MySubjects">üìò M√¥n h·ªçc c·ªßa t√¥i</a>
        <a href="/Account/Login">üö™ ƒêƒÉng xu·∫•t</a>
    </div>

    <div class="main-content">
        <!-- Ph·∫ßn 1: Hi·ªÉn th·ªã c√°c m√¥n ƒë√£ ƒëƒÉng k√Ω -->
        <header class="main-header">
            <h1>@ViewData["Title"]</h1>
            <p>Danh s√°ch c√°c m√¥n h·ªçc b·∫°n ƒë√£ ƒëƒÉng k√Ω.</p>
        </header>

        <section class="plan-list" style="margin-bottom: 40px;">
            @if (Model.EnrolledSubjects != null && Model.EnrolledSubjects.Any())
            {
                @foreach (var subject in Model.EnrolledSubjects)
                {
                    <div class="plan-card">
                        <h3>@subject.Name (@subject.SubjectCode)</h3>
                        <p><strong>Gi·∫£ng vi√™n:</strong> @subject.Instructor</p>
                        <p><strong>S·ªë t√≠n ch·ªâ:</strong> @subject.Credits</p>
                    </div>
                }
            }
            else
            {
                <div class="no-plans-message">
                    <p>B·∫°n ch∆∞a ƒëƒÉng k√Ω m√¥n h·ªçc n√†o.</p>
                </div>
            }
        </section>

        <!-- Ph·∫ßn 2: B·∫£ng ƒëƒÉng k√Ω m√¥n h·ªçc m·ªõi -->
        <header class="main-header">
            <h1>ƒêƒÉng k√Ω m√¥n h·ªçc</h1>
            <p>Ch·ªçn c√°c m√¥n h·ªçc b·∫°n mu·ªën tham gia trong k·ª≥ n√†y.</p>
        </header>
        
        <table class="content-table">
            <thead>
                <tr>
                    <th>M√£ m√¥n</th>
                    <th>T√™n m√¥n</th>
                    <th>Gi·∫£ng vi√™n</th>
                    <th>S·ªë t√≠n ch·ªâ</th>
                    <th style="width: 15%;">Tr·∫°ng th√°i</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.AllSubjects != null)
                {
                    @foreach (var subject in Model.AllSubjects)
                    {
                        <tr>
                            <td>@subject.SubjectCode</td>
                            <td>@subject.Name</td>
                            <td>@subject.Instructor</td>
                            <td>@subject.Credits</td>
                            <td>
                                @if (Model.EnrolledSubjects != null && Model.EnrolledSubjects.Any(s => s.Id == subject.Id))
                                {
                                    <!-- ƒê√£ ƒëƒÉng k√Ω -> Hi·ªÉn th·ªã n√∫t H·ªßy -->
                                    <form asp-action="Unenroll" method="post">
                                        @Html.AntiForgeryToken()
                                        <input type="hidden" name="subjectId" value="@subject.Id" />
                                        <button type="submit" class="btn btn-secondary">H·ªßy ƒëƒÉng k√Ω</button>
                                    </form>
                                }
                                else
                                {
                                    <!-- Ch∆∞a ƒëƒÉng k√Ω -> Hi·ªÉn th·ªã n√∫t ƒêƒÉng k√Ω -->
                                    <form asp-action="Enroll" method="post">
                                        @Html.AntiForgeryToken()
                                        <input type="hidden" name="subjectId" value="@subject.Id" />
                                        <button type="submit" class="btn btn-primary">ƒêƒÉng k√Ω</button>
                                    </form>
                                }
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>
</body>
</html>
